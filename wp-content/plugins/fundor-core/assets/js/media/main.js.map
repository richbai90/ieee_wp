{"version":3,"sources":["before.js","main.js","after.js"],"names":["$","OSF_MEDIA","_classCallCheck","this","product_featured_frame","campaign_gallery_frame","creator_avatar_media","on","e","preventDefault","self","open","wp","media","title","osf_media","choose_featured_img","button","state","get","text","siblings","val","attachment","id","instruction","closest","selection","wrap","find","attr","url","addClass","removeClass","currentTarget","view","settings","post","choose_file","multiple","toJSON","insertBefore","$container","console","log","$wrapper","map","ajax","type","data","action","dataType","success","complete","document","ready","jQuery"],"mappings":"0HAAA,SAAAA,GAAA,GCAAC,GACA,QAAAA,KAAAC,gBAAAC,KAAAF,EACA,IAAAG,OAAAA,GAAAC,MAAAA,GAAAC,MAAAA,EACAN,GAAA,QAAAO,GAAA,QAAA,kDAAA,SAAAC,GDHAA,EAAAC,iBAAAD,EAAAC,gBCOA,IAAAC,GAAAV,EAAAG,KALA,IAAAC,EACAJ,WADAI,GAAAO,MAGAH,IAAAA,MAAAA,KAAAA,SAAAA,KAAAA,GAAAA,EASAJ,EAAAQ,GAAAC,OAEAC,MAAAC,UAAAC,oBAPAC,QACAb,KAAAA,UAAAA,eAIAA,EAAAA,GAAAA,SAAAA,WACAA,EAAAc,QAAAC,IAAA,aAEAF,IAAAA,SAAAA,GACAG,EAAAA,EAAAA,SAWAV,EAAAW,SAAA,wBAAAC,IAAAC,EAAAC,GAGA,IAAAC,GAAAf,EAAAgB,QAAA,uBAPAC,EAAAA,EAAAA,SAAAA,cAGAC,GAAAC,KAAA,OAAAC,KAAA,MAAAP,EAAAQ,KACArB,EAAAA,KAAAA,OAAAA,WAAAA,UAEAe,EAAAO,SAAA,QACAJ,EAAAK,YAAA,YAIAL,EAAAA,SAIAA,GAAAA,QAAAA,sEAAAA,SAAAA,GACApB,EAAAC,gBAUA,IAAAC,GAAAV,EAAAQ,EAAA0B,eAPA9B,EAAAA,EAAAA,QAAAA,oBAIA,IAHAQ,GAAAC,MAAAsB,KAAAC,SAAAC,KAAAb,GAAA,EAGAnB,EAQA,WAPAG,GAAAA,MAGAH,GAAAO,GAAAC,OAEAC,MAAAC,UAAAC,oBACAX,QACAe,KAAAL,UAAAuB,aAEAjC,UAAAA,IAGAY,EAAAA,GAAAA,SAAAA,WACAG,EAAAA,QAAAA,IAAAA,aAEAmB,IAAAA,SAAAA,GAQAhB,EAAAA,EAAAiB,SAJAjB,EAAAC,IAOAxB,EAAAA,yEALA2B,EAAAA,IAKA,2KAHAJ,EAAAA,GAGA,aAHAA,EAAAA,IAGA,iDAIAkB,aAAAC,EAAAb,KAAA,qBAMAxB,EAAAM,SACAJ,GAAA,QAAA,gEAAA,SAAAC,GACAA,EAAAC,iBACAD,EAAAA,EAAAA,eAAAA,QAAAA,UAAAA,WACAR,GAAAA,QAAAA,mDAAAA,SAAAA,GACAQ,EAAAC,gBAGA,IAAAC,GAAAV,EAAAG,MAAAyB,EAAAlB,EAAAgB,QAAA,eACAD,EAAAG,EAAAP,SAAA,sBAGAI,GAAAI,KAAA,wBAAAP,IAAA,KAAAG,EAAAA,SAAAA,QACAG,EAAAA,YAAAA,UACAH,GAAAA,QAAAA,gCAAAA,SAAAA,GACAkB,QAAAC,IAAApC,EAAA0B,eACAS,EAAAA,gBACAnC,IAAAA,GAAAA,EAAAA,EAAAA,eACAqC,EAAAnC,EAAAgB,QAAA,kBACA,IAAApB,EAEAA,WADAA,GAAAK,MAGAC,IAAAC,MAAAsB,KAAAC,SAAAC,KAAAb,GAAA,EACAZ,EAAAA,GAAAA,OAEAE,MAAAC,UAAAC,oBACAF,QACAG,KAAAA,UAAAA,eAKAX,EAAAC,GAAA,SAAA,WAAAD,EAAAA,QAAAA,IAAAA,aAGAwC,IAAA,SAAAvB,GAAAI,EAAAA,EAAAA,SAGAkB,EAAAb,SAAA,WAAAa,EAAAA,KAAAA,WAAAA,KAAAA,MAAAA,EAAAA,MAAAA,iBAAAA,KAAAA,WAAAA,UAGA7C,EAAA+C,MAAA/C,KAAAA,OACAgD,IAAAA,UAAAA,QACAjB,MACAkB,OAAAA,2BACAC,UAAAA,EAAAA,IADAC,SAAA,OAIAA,QAAAA,SAAAA,GACAC,QAAAA,IAAAA,IAEAC,SAAA,WACAA,EAAAA,YAAAA,kBAQA/C,EAAAA,SAOAN,GAAAsD,UAAAC,MAAA,WACA,GAAAtD,MC1JAuD","file":"main.js","sourcesContent":["(function ($) {","class OSF_MEDIA {\n    constructor() {\n        let product_featured_frame, campaign_gallery_frame, creator_avatar_media;\n        $('body').on('click', '#opal-frontend-campaign-form a.osf-button-media', function (e) {\n            e.preventDefault();\n            e.preventDefault();\n\n            let self = $(this);\n\n            if ( product_featured_frame ) {\n                product_featured_frame.open();\n                return;\n            } else {\n                wp.media.view.settings.post.id = 0;\n                product_featured_frame = wp.media({\n                    // Set the title of the modal.\n                    title: osf_media.choose_featured_img,\n                    button: {\n                        text: osf_media.choose_file,\n                    }\n                });\n\n                product_featured_frame.on('select', function() {\n                    let selection = product_featured_frame.state().get('selection');\n\n                    selection.map( function( attachment ) {\n                        attachment = attachment.toJSON();\n\n                        // set the image hidden id\n                        self.siblings('input.featured-image').val(attachment.id);\n\n                        // set the image\n                        let instruction = self.closest('.instruction-inside');\n                        let wrap = instruction.siblings('.image-wrap');\n\n                        // wrap.find('img').attr('src', attachment.sizes.thumbnail.url);\n                        wrap.find('img').attr('src', attachment.url);\n                        wrap.find('img').removeAttr( 'srcset' );\n\n                        instruction.addClass('hide');\n                        wrap.removeClass('hide');\n                    });\n                });\n\n                product_featured_frame.open();\n            }\n\n\n        }).on('click', '#opal-frontend-campaign-form .campaign-gallery a.add-gallery-images', (e) => {\n            e.preventDefault();\n\n            let self = $(e.currentTarget);\n            let $container = self.closest('.campaign-gallery');\n            wp.media.view.settings.post.id = 0;\n            if (campaign_gallery_frame) {\n                campaign_gallery_frame.open();\n                return;\n            } else {\n                campaign_gallery_frame = wp.media({\n                    // Set the title of the modal.\n                    title: osf_media.choose_featured_img,\n                    button: {\n                        text: osf_media.choose_file,\n                    },\n                    multiple: true\n                });\n\n                campaign_gallery_frame.on('select', function () {\n                    let selection = campaign_gallery_frame.state().get('selection');\n\n                    selection.map(function (attachment) {\n\n                        attachment = attachment.toJSON();\n\n                        if (attachment.id) {\n                            $(`<li class=\"image\">\n                                        <img src=\"${attachment.url}\" />\n                                        <a href=\"#\" class=\"action-delete\">&times;</a>\n                                        <input type=\"hidden\" name=\"gallery[${attachment.id}]\" value=\"${attachment.url}\">\n                                    </li>`).insertBefore($container.find('li.add-image'));\n                        }\n\n                    });\n                });\n\n                campaign_gallery_frame.open();\n            }\n        }).on('click', '#opal-frontend-campaign-form .campaign-gallery .action-delete', (e) => {\n            e.preventDefault();\n            $(e.currentTarget).closest('.image').remove()\n        }).on('click', '#opal-frontend-campaign-form a.remove-feat-image', function (e) {\n            e.preventDefault();\n\n            let self = $(this);\n            let wrap = self.closest('.image-wrap');\n            let instruction = wrap.siblings('.instruction-inside');\n\n            instruction.find('input.featured-image').val('0');\n            wrap.addClass('hide');\n            instruction.removeClass('hide');\n        }).on('click', '.opal-give-button-edit-avatar', (e) => {\n            console.log(e.currentTarget);\n            e.preventDefault();\n            let self = $(e.currentTarget);\n            let $wrapper = self.closest('.profile-avatar');\n            if ( creator_avatar_media ) {\n                creator_avatar_media.open();\n                return;\n            } else {\n                wp.media.view.settings.post.id = 0;\n                creator_avatar_media = wp.media({\n                    // Set the title of the modal.\n                    title: osf_media.choose_featured_img,\n                    button: {\n                        text: osf_media.choose_file,\n                    }\n                });\n\n                creator_avatar_media.on('select', () => {\n                    let selection = creator_avatar_media.state().get('selection');\n\n                    selection.map( function( attachment ) {\n                        attachment = attachment.toJSON();\n\n                        $wrapper.addClass('loading')\n                        $wrapper.find('.avatar').attr('src', attachment.sizes['fundor-avatar'].url).removeAttr('srcset');\n\n                        $.ajax({\n                            type    : \"POST\",\n                            url     : osf_media.ajaxurl,\n                            data    : {\n                                action: 'opal_give_creator_avatar',\n                                avatar_id: attachment.id\n                            },\n                            dataType: 'json',\n                            success : function (data) {\n                                console.log(data);\n                            },\n                            complete: function(){\n                                $wrapper.removeClass('loading')\n                            }\n                        });\n\n                    });\n                });\n\n                creator_avatar_media.open();\n            }\n        })\n    }\n}\n\n$(document).ready(() => {\n    new OSF_MEDIA();\n})","})(jQuery);"]}